"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.getRequestURL = exports.randomString = void 0;
const crypto_1 = __importDefault(require("crypto"));
/**
 * Returns a randomly generated string, utilised for producing secret used for
 * singing session cookie.
 *
 * @returns {string}
 */
const randomString = () => {
    return crypto_1.default.randomBytes(28).toString('hex');
};
exports.randomString = randomString;
/**
 * Returns the complete URL including host and any query parameters corresponding
 * to the provided request instance.
 *
 * @param {Request} req
 * @returns {URL}
 */
const getRequestURL = (req) => {
    const host = req.get('host');
    return new URL(`${req.protocol}://${host}${req.originalUrl}`);
};
exports.getRequestURL = getRequestURL;
